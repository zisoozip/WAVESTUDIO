<!DOCTYPE html>
<html lang=ko>
<head>
<meta charset=UTF-8>
<meta name=viewport content="width=device-width, initial-scale=1.0">
<title>emotion wave 3D</title>
<script src=https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.1/gsap.min.js></script>
<style>body{margin:0;overflow:hidden;font-family:'pretendard',sans-serif;background-color:#000;color:white;cursor:none;font-weight:300}#home-button{cursor:pointer!important}#home-button:hover ~ .custom-cursor,#home-button:hover+.custom-cursor{opacity:0!important}.custom-cursor{position:fixed;width:96px;height:96px;background-image:url('image/mou.png');background-size:contain;background-repeat:no-repeat;background-position:center;pointer-events:none;transform:translate(-50%,-50%);z-index:9999;transition:transform .05s ease;opacity:0}.custom-cursor.image-loaded{opacity:1}.custom-cursor.clicking{transform:translate(-50%,-50%) scale(0.8)}.custom-cursor.hovering{transform:translate(-50%,-50%) scale(1.2)}input,textarea,select{cursor:text!important}#loading-screen{position:fixed;top:0;left:0;width:100%;height:100vh;background-color:#000;z-index:1000;overflow:hidden}#loading-screen.hidden{opacity:0;pointer-events:none;transition:opacity .5s ease}.brand-section{position:absolute;top:60px;left:60px;z-index:10}.brand-title{font-size:2rem;font-weight:100;letter-spacing:.2em;margin-bottom:20px;opacity:1}.brand-description{font-size:.9rem;line-height:1.6;opacity:.6;max-width:500px;font-weight:300}.loading-section{position:absolute;right:60px;bottom:150px;text-align:right}.loading-number{font-size:12rem;font-weight:100;line-height:.8;letter-spacing:-0.05em;color:rgba(255,255,255,0.8);transition:all .3s cubic-bezier(0.4,0,0.2,1);transform-origin:bottom right}.progress-bar{position:absolute;bottom:80px;right:60px;width:400px;height:1px;background-color:rgba(255,255,255,0.1);overflow:hidden}.progress-fill{height:100%;background:rgba(255,255,255,0.6);transition:width .1s ease}@keyframes gentlePulse{0%,100%{opacity:.8}50%{opacity:1}}.number-pulsing{animation:gentlePulse 3s ease-in-out infinite}canvas{display:block;cursor:pointer}#info{position:absolute;top:20px;width:100%;text-align:center;z-index:100;padding:10px}#controls{position:absolute;bottom:20px;width:100%;text-align:center;z-index:100;padding:10px;display:flex;justify-content:center;gap:15px}button{background:transparent;color:white;border:1px solid rgba(255,255,255,0.3);padding:8px 16px;border-radius:20px;cursor:pointer;transition:all .3s;font-size:12px;font-weight:300}button:hover{border-color:rgba(255,255,255,0.6);transform:scale(1.02)}button.active{border-color:rgba(255,255,255,0.8);background:rgba(255,255,255,0.05)}#title{font-size:1.8rem;margin-bottom:10px;font-weight:600;letter-spacing:normal}#description{font-size:14px;max-width:600px;margin:0 auto 30px auto;opacity:.6;font-weight:300;line-height:1.5}#interaction-info{position:absolute;top:120px;width:100%;text-align:center;z-index:100;font-size:12px;opacity:.5;padding:10px 0;font-weight:300}.interaction-mode{position:absolute;right:20px;top:20px;display:flex;flex-direction:column;gap:8px;z-index:100}.mode-button{background:transparent;color:white;border:1px solid rgba(255,255,255,0.2);padding:4px 8px;border-radius:15px;cursor:pointer;transition:all .2s;font-size:10px;text-align:center;font-weight:300}.mode-button:hover{border-color:rgba(255,255,255,0.4)}.mode-button.active{border-color:rgba(255,255,255,0.6);background:rgba(255,255,255,0.05)}#home-button{position:fixed;left:20px;top:20px;z-index:10000;width:50px;height:50px;background:transparent;border:1px solid rgba(255,255,255,0.2);border-radius:50%;cursor:pointer!important;display:flex;align-items:center;justify-content:center;transition:all .3s ease;pointer-events:all}#home-button:hover{border-color:rgba(255,255,255,0.6);transform:scale(1.05);cursor:pointer!important}#home-button svg{width:20px;height:20px;fill:rgba(255,255,255,0.6);transition:all .3s ease;pointer-events:none}#home-button:hover svg{fill:rgba(255,255,255,1)}@media(max-width:768px){.brand-title{font-size:1.5rem}.loading-number{font-size:8rem}#controls{flex-wrap:wrap;gap:8px;bottom:15px}button{padding:6px 12px;font-size:11px}#title{font-size:1.5rem}}</style>
</head>
<body>
<div class=custom-cursor id=customCursor></div>
<div id=loading-screen>
<div class=brand-section>
<div class=brand-title style=font-weight:600;letter-spacing:normal>EMOTION WAVE</div>
<div class=brand-description>
6개의 감정을 3D 파동으로 표현하는 인터랙티브 경험.<br>
마우스와 버튼으로 감정의 파동을 탐험해보세요.
</div>
</div>
<div class=loading-section>
<div class=loading-number id=loadingNumber>0</div>
</div>
<div class=progress-bar>
<div class=progress-fill id=progressFill></div>
</div>
</div>
<div id=home-button>
<svg viewBox="0 0 24 24">
<path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
</svg>
</div>
<div id=info>
<div id=title>EMOTION WAVE</div>
<div id=description>6개의 감정을 3D 파동으로 시각화했습니다.<br> 하단의 버튼과 마우스를 클릭해 다양한 감정의 파동을 경험해보세요.</div>
</div>
<div id=interaction-info>
마우스 움직임: 카메라 회전 | 휠: 확대/축소 | 클릭: 파동 생성 | 더블클릭: 리플 효과
</div>
<div id=controls>
<button id=joy class=active>환희</button>
<button id=sadness>애수</button>
<button id=anger>격노</button>
<button id=fear>불안</button>
<button id=love>사랑</button>
<button id=peace>고요</button>
</div>
<div class=interaction-mode>
<div class="mode-button active" id=rotate-mode>ROTATE MODE</div>
<div class=mode-button id=wave-mode>WAVE MODE</div>
<div class=mode-button id=particle-mode>PARTICLE MODE</div>
</div>
<script>let currentNumber=0;let displayNumber=0;const targetNumber=100;const loadingNumberEl=document.getElementById('loadingNumber');const progressFillEl=document.getElementById('progressFill');let animationId;let startTime;const duration=4000;function goHome(){try{console.log('홈 버튼 클릭됨!');if(window.location.protocol==='file:'){window.location.href='./index.html#list-section';}else{window.location.href='/index.html#list-section';}}catch(error){console.error('홈 페이지 이동 오류:',error);if(window.location.protocol==='file:'){window.location.href='./index.html#list-section';}else{window.location.href='/index.html#list-section';}}}
function setupHomeButton(){const homeButton=document.getElementById('home-button');if(homeButton){console.log('홈 버튼 찾음:',homeButton);homeButton.addEventListener('click',function(e){console.log('홈 버튼 클릭 이벤트 발생');e.preventDefault();e.stopPropagation();goHome();});homeButton.addEventListener('mousedown',function(e){console.log('홈 버튼 마우스다운 이벤트');e.stopPropagation();});homeButton.addEventListener('touchstart',function(e){console.log('홈 버튼 터치 이벤트');e.preventDefault();e.stopPropagation();goHome();},{passive:false});homeButton.style.pointerEvents='all';homeButton.style.cursor='pointer';}else{console.error('홈 버튼을 찾을 수 없습니다');}}
document.addEventListener('DOMContentLoaded',setupHomeButton);class CustomCursor{constructor(){this.cursor=document.getElementById('customCursor');this.mouseX=window.innerWidth/2;this.mouseY=window.innerHeight/2;this.isClicking=false;this.imageLoaded=false;this.preloadCursorImage();this.init();}
preloadCursorImage(){const img=new Image();img.onload=()=>{this.imageLoaded=true;if(this.cursor){this.cursor.classList.add('image-loaded');this.cursor.style.opacity='1';}};img.onerror=()=>{document.body.style.cursor='auto';if(this.cursor){this.cursor.style.display='none';}};img.src='image/mou.png';}
init(){if(!this.cursor)return;this.updateCursorPosition();document.addEventListener('mousemove',(e)=>{this.mouseX=e.clientX;this.mouseY=e.clientY;this.updateCursorPosition();});document.addEventListener('mousedown',()=>{this.isClicking=true;this.cursor.classList.add('clicking');});document.addEventListener('mouseup',()=>{this.isClicking=false;this.cursor.classList.remove('clicking');});document.addEventListener('mouseenter',(e)=>{if(this.isHoverTarget(e.target)){if(!this.isClicking){this.cursor.classList.add('hovering');}}},true);document.addEventListener('mouseleave',(e)=>{if(this.isHoverTarget(e.target)){this.cursor.classList.remove('hovering');}},true);}
isHoverTarget(element){if(!element||!element.classList)return false;const targetClasses=['mode-button'];const targetTags=['BUTTON'];const targetIds=['home-button'];for(let className of targetClasses){if(element.classList.contains(className)){return true;}}
if(element.tagName&&targetTags.includes(element.tagName.toUpperCase())){return true;}
if(element.id&&targetIds.includes(element.id)){return true;}
return false;}
updateCursorPosition(){if(this.cursor&&this.imageLoaded){const homeButton=document.getElementById('home-button');if(homeButton){const rect=homeButton.getBoundingClientRect();const buffer=10;if(this.mouseX>=rect.left-buffer&&this.mouseX<=rect.right+buffer&&this.mouseY>=rect.top-buffer&&this.mouseY<=rect.bottom+buffer){this.cursor.style.opacity='0';document.body.style.cursor='pointer';return;}else{this.cursor.style.opacity='1';document.body.style.cursor='none';}}
this.cursor.style.left=this.mouseX+'px';this.cursor.style.top=this.mouseY+'px';}}}
function animateLoadingNumber(timestamp){if(!startTime)startTime=timestamp;const elapsed=timestamp-startTime;const progress=Math.min(elapsed/duration,1);const easedProgress=1-Math.pow(1-progress,3);displayNumber=easedProgress*targetNumber;const roundedNumber=progress>=1?targetNumber:Math.floor(displayNumber);loadingNumberEl.textContent=roundedNumber;const progressPercentage=(roundedNumber/targetNumber)*100;progressFillEl.style.width=progressPercentage+'%';if(progress<1){animationId=requestAnimationFrame(animateLoadingNumber);}else{loadingNumberEl.classList.remove('number-pulsing');setTimeout(()=>{document.getElementById('loading-screen').classList.add('hidden');setTimeout(()=>{init();setupHomeButton();},500);},1000);}}
let isDarkMode=true;let scene,camera,renderer,raycaster,mouse;let waveGeometry,waveMaterial,waveMesh;let currentEmotion="joy";let threeAnimationId;let time=0;let isMouseDown=false;let mouseX=0,mouseY=0;let targetRotationX=0,targetRotationY=0;let interactionMode="rotate";let lastTap=0;let dragSensitivity=1.0;let dampingFactor=0.05;let enableInertia=true;let inertiaX=0,inertiaY=0;const mousePosition=new THREE.Vector2();const lastMousePosition=new THREE.Vector2();const mouseDelta=new THREE.Vector2();const emotionParams={joy:{color:new THREE.Color(255/255,215/255,0/255),amplitude:0.4,frequency:1.5,speed:0.01,complexity:3,spikyness:0.3,particles:true},sadness:{color:new THREE.Color(70/255,130/255,180/255),amplitude:0.2,frequency:0.7,speed:0.005,complexity:1,spikyness:0.1,particles:false},anger:{color:new THREE.Color(255/255,0/255,0/255),amplitude:0.5,frequency:2.0,speed:0.02,complexity:5,spikyness:0.7,particles:true},fear:{color:new THREE.Color(128/255,0/255,128/255),amplitude:0.35,frequency:1.8,speed:0.015,complexity:4,spikyness:0.5,particles:false},love:{color:new THREE.Color(255/255,105/255,180/255),amplitude:0.3,frequency:1.2,speed:0.01,complexity:2,spikyness:0.2,particles:true},peace:{color:new THREE.Color(127/255,255/255,212/255),amplitude:0.25,frequency:0.8,speed:0.007,complexity:1,spikyness:0.05,particles:false}};let particleSystem;let particleTexture;const particles=[];const particleCount=2000;const clickEffects=[];function createCircleTexture(){const canvas=document.createElement('canvas');const size=64;canvas.width=size;canvas.height=size;const context=canvas.getContext('2d');const centerX=size/2;const centerY=size/2;const radius=size/2;context.clearRect(0,0,size,size);context.fillStyle='white';context.beginPath();context.arc(centerX,centerY,radius,0,Math.PI*2);context.fill();const texture=new THREE.Texture(canvas);texture.needsUpdate=true;return texture;}
function init(){scene=new THREE.Scene();scene.background=new THREE.Color(0x000000);camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);camera.position.z=5;renderer=new THREE.WebGLRenderer({antialias:true});renderer.setSize(window.innerWidth,window.innerHeight);document.body.appendChild(renderer.domElement);raycaster=new THREE.Raycaster();mouse=new THREE.Vector2();const ambientLight=new THREE.AmbientLight(0xffffff,0.6);scene.add(ambientLight);const directionalLight=new THREE.DirectionalLight(0xffffff,0.8);directionalLight.position.set(0,1,1);scene.add(directionalLight);particleTexture=createCircleTexture();createWaveMesh();createParticleSystem();window.addEventListener('resize',onWindowResize);window.addEventListener('mousemove',onMouseMove);window.addEventListener('mousedown',onMouseDown);window.addEventListener('mouseup',onMouseUp);window.addEventListener('wheel',onMouseWheel);window.addEventListener('dblclick',onDoubleClick);window.addEventListener('click',onClick);window.addEventListener('touchstart',onTouchStart);window.addEventListener('touchmove',onTouchMove);window.addEventListener('touchend',onTouchEnd);setupInteractionModeButtons();setupEmotionButtons();animate();}
function createWaveMesh(){const resolution=100;waveGeometry=new THREE.PlaneGeometry(10,10,resolution,resolution);const params=emotionParams[currentEmotion];waveMaterial=new THREE.MeshStandardMaterial({color:params.color,wireframe:true,emissive:params.color,emissiveIntensity:0.3,side:THREE.DoubleSide});waveMesh=new THREE.Mesh(waveGeometry,waveMaterial);waveMesh.rotation.x=Math.PI/2;scene.add(waveMesh);}
function createParticleSystem(){const particleGeometry=new THREE.BufferGeometry();const positions=new Float32Array(particleCount*3);const colors=new Float32Array(particleCount*3);for(let i=0;i<particleCount;i++){const i3=i*3;positions[i3]=(Math.random()-0.5)*10;positions[i3+1]=(Math.random()-0.5)*10;positions[i3+2]=(Math.random()-0.5)*10;particles.push({position:new THREE.Vector3(positions[i3],positions[i3+1],positions[i3+2]),velocity:new THREE.Vector3((Math.random()-0.5)*0.02,(Math.random()-0.5)*0.02,(Math.random()-0.5)*0.02),initialLife:Math.random()*2+1,life:Math.random()*2+1,attracted:false,attractionPoint:new THREE.Vector3()});const color=emotionParams[currentEmotion].color;colors[i3]=color.r;colors[i3+1]=color.g;colors[i3+2]=color.b;}
particleGeometry.setAttribute('position',new THREE.BufferAttribute(positions,3));particleGeometry.setAttribute('color',new THREE.BufferAttribute(colors,3));const particleMaterial=new THREE.PointsMaterial({size:0.02,vertexColors:true,transparent:false,opacity:1.0,blending:THREE.NormalBlending,map:particleTexture,depthWrite:true});particleSystem=new THREE.Points(particleGeometry,particleMaterial);scene.add(particleSystem);}
function changeEmotion(emotion){if(emotion===currentEmotion)return;currentEmotion=emotion;document.querySelectorAll('#controls button').forEach(btn=>{btn.classList.remove('active');});document.getElementById(emotion).classList.add('active');const params=emotionParams[emotion];gsap.to(waveMaterial.color,{r:params.color.r,g:params.color.g,b:params.color.b,duration:1});gsap.to(waveMaterial.emissive,{r:params.color.r,g:params.color.g,b:params.color.b,duration:1});if(particleSystem){const colors=particleSystem.geometry.attributes.color.array;const newColor=params.color;for(let i=0;i<particleCount;i++){const i3=i*3;gsap.to(particleSystem.geometry.attributes.color.array,{[i3]:newColor.r,[i3+1]:newColor.g,[i3+2]:newColor.b,duration:1+Math.random()*0.5});}
if(params.particles){particleSystem.visible=true;gsap.to(particleSystem.material,{opacity:1.0,duration:1});}else{gsap.to(particleSystem.material,{opacity:0,duration:1,onComplete:()=>{particleSystem.visible=false;}});}}}
function setupEmotionButtons(){Object.keys(emotionParams).forEach(emotion=>{document.getElementById(emotion).addEventListener('click',()=>{changeEmotion(emotion);});});}
function setupInteractionModeButtons(){document.getElementById('rotate-mode').addEventListener('click',()=>{setInteractionMode('rotate');});document.getElementById('wave-mode').addEventListener('click',()=>{setInteractionMode('wave');});document.getElementById('particle-mode').addEventListener('click',()=>{setInteractionMode('particle');});}
function setInteractionMode(mode){interactionMode=mode;document.querySelectorAll('.mode-button').forEach(btn=>{btn.classList.remove('active');});let modeButtonId='';switch(mode){case'rotate':modeButtonId='rotate-mode';break;case'wave':modeButtonId='wave-mode';break;case'particle':modeButtonId='particle-mode';break;}
document.getElementById(modeButtonId).classList.add('active');let infoText='';switch(mode){case'rotate':infoText='마우스 움직임: 카메라 회전 | 휠: 확대/축소 | 클릭: 파동 생성 | 더블클릭: 리플 효과';break;case'wave':infoText='마우스 움직임: 파동 변형 | 클릭: 파동 강화 | 휠: 파동 높이 조절';break;case'particle':infoText='마우스 움직임: 파티클 끌어당김 | 클릭: 파티클 폭발 | 휠: 파티클 크기 조절';break;}
document.getElementById('interaction-info').textContent=infoText;}
function createClickEffect(x,y){raycaster.setFromCamera(new THREE.Vector2(x,y),camera);const intersects=raycaster.intersectObject(waveMesh);if(intersects.length>0){const point=intersects[0].point;const effect={center:new THREE.Vector3(point.x,point.y,point.z),radius:0,maxRadius:3,strength:1,life:1,decay:0.02};clickEffects.push(effect);if(interactionMode==='particle'&&particleSystem.visible){createParticleExplosion(point);}}}
function createParticleExplosion(position){const explosionForce=0.15;const affectedRadius=2;for(let i=0;i<particleCount;i++){const particle=particles[i];const distance=particle.position.distanceTo(position);if(distance<affectedRadius){const direction=new THREE.Vector3().subVectors(particle.position,position).normalize();const force=explosionForce*(1-distance/affectedRadius);particle.velocity.add(direction.multiplyScalar(force));const particleindex=i*3;const colorParams=emotionParams[currentEmotion].color;particleSystem.geometry.attributes.color.array[particleindex]=colorParams.r;particleSystem.geometry.attributes.color.array[particleindex+1]=colorParams.g;particleSystem.geometry.attributes.color.array[particleindex+2]=colorParams.b;}}
particleSystem.geometry.attributes.color.needsUpdate=true;}
function createRippleEffect(x,y){raycaster.setFromCamera(new THREE.Vector2(x,y),camera);const intersects=raycaster.intersectObject(waveMesh);if(intersects.length>0){const point=intersects[0].point;const effect={center:new THREE.Vector2(point.x,point.y),speed:1.5,frequency:3,amplitude:0.5*emotionParams[currentEmotion].amplitude,life:2,decay:0.01,time:0};effect.isRipple=true;clickEffects.push(effect);gsap.to(camera,{fov:camera.fov-5,duration:0.3,onComplete:()=>{gsap.to(camera,{fov:camera.fov+5,duration:0.7});},onUpdate:()=>{camera.updateProjectionMatrix();}});}}
function animate(){threeAnimationId=requestAnimationFrame(animate);time+=emotionParams[currentEmotion].speed;if(interactionMode==='rotate'){if(enableInertia&&!isMouseDown){targetRotationX+=inertiaX;targetRotationY+=inertiaY;inertiaX*=0.95;inertiaY*=0.95;if(Math.abs(inertiaX)<0.001)inertiaX=0;if(Math.abs(inertiaY)<0.001)inertiaY=0;}
waveMesh.rotation.z+=(targetRotationX-waveMesh.rotation.z)*dampingFactor;const verticalRotation=(targetRotationY-camera.position.y)*dampingFactor;camera.position.y+=verticalRotation;camera.lookAt(scene.position);}
updateWave();if(particleSystem.visible){updateParticles();}
updateClickEffects();renderer.render(scene,camera);}
function updateWave(){const params=emotionParams[currentEmotion];const positions=waveGeometry.attributes.position.array;for(let i=0;i<positions.length;i+=3){const x=positions[i];const y=positions[i+1];const distance=Math.sqrt(x*x+y*y);let z=0;for(let j=1;j<=params.complexity;j++){z+=Math.sin(distance*params.frequency/j+time)*Math.cos(x*params.frequency/j+time)*Math.sin(y*params.frequency/j+time)*params.amplitude/j;}
if(interactionMode==='wave'&&isMouseDown){const dx=x-(mousePosition.x*10-5);const dy=y-(mousePosition.y*10-5);const mouseDist=Math.sqrt(dx*dx+dy*dy);if(mouseDist<3){const influence=1-mouseDist/3;z+=influence*params.amplitude*Math.sin(time*10)*0.5;}}
for(let e=0;e<clickEffects.length;e++){const effect=clickEffects[e];if(effect.isRipple){const dx=x-effect.center.x;const dy=y-effect.center.y;const dist=Math.sqrt(dx*dx+dy*dy);if(dist<effect.speed*effect.time&&dist>effect.speed*effect.time-1){z+=Math.sin(effect.frequency*(dist-effect.time))*effect.amplitude*effect.life;}}else{const dx=x-effect.center.x;const dy=y-effect.center.y;const dist=Math.sqrt(dx*dx+dy*dy);if(dist<effect.radius){const rippleFactor=1-dist/effect.radius;z+=rippleFactor*effect.strength*effect.life*0.5;}}}
z+=(Math.random()-0.5)*params.spikyness*params.amplitude;positions[i+2]=z;}
waveGeometry.attributes.position.needsUpdate=true;if(interactionMode!=='rotate'){waveMesh.rotation.z+=params.speed*0.2;}}
function updateClickEffects(){for(let i=clickEffects.length-1;i>=0;i--){const effect=clickEffects[i];if(effect.isRipple){effect.time+=0.05;effect.life-=effect.decay;if(effect.life<=0){clickEffects.splice(i,1);}}else{effect.radius+=0.05;effect.life-=0.02;effect.strength=effect.life;if(effect.radius>=effect.maxRadius||effect.life<=0){clickEffects.splice(i,1);}}}}
function updateParticles(){const params=emotionParams[currentEmotion];const positions=particleSystem.geometry.attributes.position.array;for(let i=0;i<particleCount;i++){const i3=i*3;const particle=particles[i];if(interactionMode==='particle'&&isMouseDown){raycaster.setFromCamera(mousePosition,camera);const mouseIn3D=new THREE.Vector3();mouseIn3D.copy(raycaster.ray.direction);mouseIn3D.multiplyScalar(5);mouseIn3D.add(camera.position);const attractionStrength=0.01;const direction=new THREE.Vector3();direction.subVectors(mouseIn3D,particle.position).normalize();const distance=particle.position.distanceTo(mouseIn3D);if(distance<3){const force=attractionStrength*(1-distance/3);particle.velocity.add(direction.multiplyScalar(force));}}
particle.position.add(particle.velocity);if(Math.abs(particle.position.x)>5){particle.velocity.x*=-0.9;particle.position.x=Math.sign(particle.position.x)*5*0.99;}
if(Math.abs(particle.position.y)>5){particle.velocity.y*=-0.9;particle.position.y=Math.sign(particle.position.y)*5*0.99;}
if(Math.abs(particle.position.z)>5){particle.velocity.z*=-0.9;particle.position.z=Math.sign(particle.position.z)*5*0.99;}
particle.velocity.x+=(Math.random()-0.5)*params.speed*0.1;particle.velocity.y+=(Math.random()-0.5)*params.speed*0.1;particle.velocity.z+=(Math.random()-0.5)*params.speed*0.1;particle.velocity.multiplyScalar(0.99);positions[i3]=particle.position.x;positions[i3+1]=particle.position.y;positions[i3+2]=particle.position.z;particle.life-=0.01;if(particle.life<=0){particle.position.set((Math.random()-0.5)*10,(Math.random()-0.5)*10,(Math.random()-0.5)*10);particle.velocity.set((Math.random()-0.5)*0.02,(Math.random()-0.5)*0.02,(Math.random()-0.5)*0.02);particle.life=particle.initialLife;}}
particleSystem.geometry.attributes.position.needsUpdate=true;particleSystem.geometry.attributes.color.needsUpdate=true;}
function onMouseMove(event){lastMousePosition.copy(mousePosition);mousePosition.x=(event.clientX/window.innerWidth)*2-1;mousePosition.y=-(event.clientY/window.innerHeight)*2+1;mouseDelta.subVectors(mousePosition,lastMousePosition);if(interactionMode==='rotate'&&isMouseDown){targetRotationX+=mouseDelta.x*2*dragSensitivity;targetRotationY+=mouseDelta.y*2*dragSensitivity;if(enableInertia){inertiaX=mouseDelta.x*dragSensitivity*0.5;inertiaY=mouseDelta.y*dragSensitivity*0.5;}}}
function onMouseDown(event){if(event.target.closest('#home-button')){return;}
isMouseDown=true;mousePosition.x=(event.clientX/window.innerWidth)*2-1;mousePosition.y=-(event.clientY/window.innerHeight)*2+1;}
function onMouseUp(event){isMouseDown=false;if(!enableInertia){inertiaX=0;inertiaY=0;}
if(event&&event.target.classList.contains('mode-button')){inertiaX=0;inertiaY=0;}}
function onMouseWheel(event){const delta=Math.sign(event.deltaY);if(interactionMode==='rotate'){camera.position.z+=delta*0.5;camera.position.z=Math.max(2,Math.min(15,camera.position.z));}else if(interactionMode==='wave'){const currentParams=emotionParams[currentEmotion];currentParams.amplitude=Math.max(0.1,Math.min(1,currentParams.amplitude+delta*0.05));}else if(interactionMode==='particle'){const newSize=Math.max(0.005,Math.min(0.08,particleSystem.material.size+delta*0.005));particleSystem.material.size=newSize;}}
function onClick(event){const x=(event.clientX/window.innerWidth)*2-1;const y=-(event.clientY/window.innerHeight)*2+1;if(event.target.tagName.toLowerCase()==='button'){return;}
if(event.target.closest('#home-button')){return;}
createClickEffect(x,y);}
function onDoubleClick(event){const x=(event.clientX/window.innerWidth)*2-1;const y=-(event.clientY/window.innerHeight)*2+1;if(event.target.tagName.toLowerCase()==='button'){return;}
if(event.target.closest('#home-button')){return;}
createRippleEffect(x,y);}
function onTouchStart(event){event.preventDefault();if(event.touches.length===1){isMouseDown=true;mousePosition.x=(event.touches[0].clientX/window.innerWidth)*2-1;mousePosition.y=-(event.touches[0].clientY/window.innerHeight)*2+1;const currentTime=new Date().getTime();const tapLength=currentTime-lastTap;if(tapLength<300&&tapLength>0){createRippleEffect(mousePosition.x,mousePosition.y);}else{createClickEffect(mousePosition.x,mousePosition.y);}
lastTap=currentTime;}}
function onTouchMove(event){if(event.touches.length===1){event.preventDefault();lastMousePosition.copy(mousePosition);mousePosition.x=(event.touches[0].clientX/window.innerWidth)*2-1;mousePosition.y=-(event.touches[0].clientY/window.innerHeight)*2+1;mouseDelta.subVectors(mousePosition,lastMousePosition);if(interactionMode==='rotate'&&isMouseDown){targetRotationX+=mouseDelta.x*2;targetRotationY+=mouseDelta.y*2;}}}
function onTouchEnd(event){isMouseDown=false;}
function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight);}
window.addEventListener('load',()=>{new CustomCursor();setTimeout(()=>{loadingNumberEl.classList.add('number-pulsing');animationId=requestAnimationFrame(animateLoadingNumber);},500);});</script>
</body>
</html>